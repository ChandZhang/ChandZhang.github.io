(function(f,e){"object"===typeof module&&"object"===typeof exports?module["export"]=e():"function"===typeof define&&define.amd?define([],e):f.httpVueLoader=e()})(this,function(){function f(a,b){this.component=a;this.elt=b}function e(a,b){this.component=a;this.elt=b;this.module={exports:{}}}function n(a,b){this.component=a;this.elt=b}function p(a){this.name=a;this.script=this.template=null;this.styles=[];this._scopeId=""}function k(a){return a}function l(a){a=a.match(/(.*?)([^/]+?)\/?(\.vue)?(\?.*|#.*|$)/);return{name:a[2],url:a[1]+a[2]+(void 0===a[3]?"/index.vue":a[3])+a[4]}}function m(a,b){return"./"===b.substr(0,2)||"../"===b.substr(0,3)?a+b:b}function d(a,b){var c=l(a);return d.load(c.url,b)}var q=0;f.prototype={withBase:function(a){var b;if(this.component.baseURI){b=document.createElement("base");b.href=this.component.baseURI;var c=this.component.getHead();c.insertBefore(b,c.firstChild)}a.call(this);b&&this.component.getHead().removeChild(b)},scopeStyles:function(a,b){function c(){for(var c=a.sheet,d=c.cssRules,h=0;h<d.length;++h){var e=d[h];if(1===e.type){var f=[];e.selectorText.split(/\s*,\s*/).forEach(function(a){f.push(b+" "+a);a=a.match(/([^ :]+)(.+)?/);f.push(a[1]+b+(a[2]||""))});e=f.join(",")+e.cssText.substr(e.selectorText.length);c.deleteRule(h);c.insertRule(e,h)}}}try{c()}catch(g){if(g instanceof DOMException&&g.code===DOMException.INVALID_ACCESS_ERR)a.sheet.disabled=!0,a.addEventListener("load",function h(){a.removeEventListener("load",h);setTimeout(function(){c();a.sheet.disabled=!1})});else throw g;}},compile:function(){var a=null!==this.template,b=this.elt.hasAttribute("scoped");if(b){if(!a)return;this.elt.removeAttribute("scoped")}this.withBase(function(){this.component.getHead().appendChild(this.elt)});b&&this.scopeStyles(this.elt,"["+this.component.getScopeId()+"]");return Promise.resolve()},getContent:function(){return this.elt.textContent},setContent:function(a){this.withBase(function(){this.elt.textContent=a})}};e.prototype={getContent:function(){return this.elt.textContent},setContent:function(a){this.elt.textContent=a},compile:function(a){a=function(a){return d.require(m(this.component.baseURI,a))}.bind(this);var b=function(a,b){return d(m(this.component.baseURI,a),b)}.bind(this);try{Function("exports","require","httpVueLoader","module",this.getContent()).call(this.module.exports,this.module.exports,a,b,this.module)}catch(c){if(!("lineNumber"in c))return Promise.reject(c);a=responseText.replace(/\r?\n/g,"\n");a=a.substr(0,a.indexOf(script)).split("\n").length+c.lineNumber-1;throw new c.constructor(c.message,url,a);}return Promise.resolve(this.module.exports)}};n.prototype={getContent:function(){return this.elt.innerHTML},setContent:function(a){this.elt.innerHTML=a},getRootElt:function(){var a=this.elt.content||this.elt;if("firstElementChild"in a)return a.firstElementChild;for(a=a.firstChild;null!==a;a=a.nextSibling)if(a.nodeType===Node.ELEMENT_NODE)return a;return null},compile:function(){return Promise.resolve()}};p.prototype={getHead:function(){return document.head||document.getElementsByTagName("head")[0]},getScopeId:function(){""===this._scopeId&&(this._scopeId="data-s-"+(q++).toString(36),this.template.getRootElt().setAttribute(this._scopeId,""));return this._scopeId},load:function(a){return d.httpRequest(a).then(function(b){this.baseURI=a.substr(0,a.lastIndexOf("/")+1);var c=document.implementation.createHTMLDocument("");c.body.innerHTML=(this.baseURI?'\x3cbase href\x3d"'+this.baseURI+'"\x3e':"")+b;for(b=c.body.firstChild;b;b=b.nextSibling)switch(b.nodeName){case "TEMPLATE":this.template=new n(this,b);break;case "SCRIPT":this.script=new e(this,b);break;case "STYLE":this.styles.push(new f(this,b))}return this}.bind(this))},_normalizeSection:function(a){return(null!==a&&a.elt.hasAttribute("src")?d.httpRequest(a.elt.getAttribute("src")).then(function(b){a.elt.removeAttribute("src");return b}):Promise.resolve(null)).then(function(b){if(null!==a&&a.elt.hasAttribute("lang")){var c=a.elt.getAttribute("lang");a.elt.removeAttribute("lang");return d.langProcessor[c.toLowerCase()](null===b?a.getContent():b)}return b}).then(function(b){null!==b&&a.setContent(b)})},normalize:function(){return Promise.all(Array.prototype.concat(this._normalizeSection(this.template),this._normalizeSection(this.script),this.styles.map(this._normalizeSection))).then(function(){return this}.bind(this))},compile:function(){return Promise.all(Array.prototype.concat(this.template&&this.template.compile(),this.script&&this.script.compile(),this.styles.map(function(a){return a.compile()}))).then(function(){return this}.bind(this))}};d.load=function(a,b){return function(){return(new p(b)).load(a).then(function(a){return a.normalize()}).then(function(a){return a.compile()}).then(function(a){var b=null!==a.script?a.script.module.exports:{};null!==a.template&&(b.template=a.template.getContent());void 0===b.name&&void 0!==a.name&&(b.name=a.name);b._baseURI=a.baseURI;return b})}};d.register=function(a,b){var c=l(b);a.component(c.name,d.load(c.url))};d.install=function(a){a.mixin({beforeCreate:function(){var b=this.$options.components,c;for(c in b)if("string"===typeof b[c]&&"url:"===b[c].substr(0,4)){var g=l(b[c].substr(4)),e="_baseURI"in this.$options?m(this.$options._baseURI,g.url):g.url;isNaN(c)?b[c]=d.load(e,c):b[c]=a.component(g.name,d.load(e,g.name))}}})};d.require=function(a){return window[a]};d.httpRequest=function(a){return new Promise(function(b,c){var d=new XMLHttpRequest;d.open("GET",a);d.onreadystatechange=function(){4===d.readyState&&(200<=d.status&&300>d.status?b(d.responseText):c(d.status))};d.send(null)})};d.langProcessor={html:k,js:k,css:k};return d});